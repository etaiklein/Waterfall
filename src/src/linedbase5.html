<!DOCTYPE html>
<!-- version check
<!-- localhost/linedbase3.php?link=./Data/ScreenCapAt1381654112396/*.jpg  -->

<html lang"en">
  <body>
  	   <meta charset="utf-8">

    <title>...</title>
    	<script type="text/javascript" src="../external/jquery-2.0.2.min.js"></script>

    <script type="text/javascript" src="../external/waterfall.js"></script>
    
	<script type="text/javascript" id="key" src="./Data/key.js"></script>

     <link rel="stylesheet" type="text/css" href="waterfall4.css" /> 

<script src="../external/js/highcharts.js"></script>
<script src="../external/js/highcharts-more.js"></script>
<script src="../external/js/modules/exporting.js"></script>
	
	<!-- charts -->

	
	<div id="bigcontainer">
	
	<div class="media" id="media">
    <div class="imageContainer"> 
	<script type="text/javascript" id="images" src="./Data/images.js"></script>
  	</div>
  	</div>
  
  
  <div id="container0" class= "container"></div>
  <div id="container1" class= "container"></div>
  <div id="container2" class= "container"></div>
  <div id="container3" class= "container"></div>
  <div id="container4" class= "container"></div>
  <div id="container5" class= "container"></div>
  <div id="container6" class= "container"></div>
  <div id="container7" class= "container"></div>
  <div id="container8" class= "container"></div>
  <div id="container9" class= "container"></div>
  <div id="container10" class= "container"></div>
  <div id="container11" class= "container"></div>
  <div id="container12" class= "container"></div>
  <div id="container13" class= "container"></div>
  <div id="container14" class= "container"></div>
  <div id="container15" class= "container"></div>
  <div id="container16" class= "container"></div>


	<!--function to replace the waterfalls at a given scroll position
	var outnames - the names of the files containing the waterfalls
	scrollPercent - Percent of the image container scrolled through
	starttimes - the time each waterfall starts
	endtimes - the time each waterfall ends
	-->
	<script type="text/javascript" >
	var length = outnames.length;
	var index;
	
	var path = outnames[0];

	document.writeln("<script type=\"text/javascript\" src="+path+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[1]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[2]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[3]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[4]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[5]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[6]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[7]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[8]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[9]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[10]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[11]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[12]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[13]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[14]+"\>\</script\>");
	document.writeln("<script type=\"text/javascript\" src="+outnames[15]+"\>\</script\>");


	var i = 0;
	var hi = 0;
	
	$(document).ready(function(){

                setInterval(function() {

 
			        var element = document.getElementById('media');
			        style = window.getComputedStyle(element);
			        var scrollPercent = ((element.scrollLeft) / (element.scrollWidth - element.clientWidth + .001));
			        var startPercent = (starttimes[i] / endtimes[length-1]);
        			var endPercent = (endtimes[i] / endtimes[length-1]);
        			var calculatedPercent = (scrollPercent - startPercent)/(endPercent - startPercent);
										
					//what is my current item?
					//if I pass my current item on either side, then switch
					//the problem: the time is not matched on start/end and the graph itself.
					
					//idea: everytime the mark is hit, rewrite the first line of the .js file stating current = ??
					//Then keep everything on one file. 
					
					if (calculatedPercent < 0){
						if (i != 0){
							//$('script[src="' + outnames[i] + '"]').remove();
							//$('<script>').attr('src', outnames[i-1]).appendTo('head');
							//document.getElementById('container').display = 'none';
     						//document.getElementById('container' + (i-1).toString()).display = '';
     						//$('.outnames' + (i).toString()).hide();
     						//outnames.src=outnames[i-1];
     						//document.getElementById('container').style.display = 'auto';
     						$('#container'+(i).toString()).hide();
     						$('#container' +(i-1).toString()).show();
     					    console.log("moved down" + (i-1).toString());

     						
						i = i - 1;
													}
					}
					if (calculatedPercent >= 1){
						if (i != length-1){
							i = i + 1;
							//     						outnames.src=outnames[i];
							//if ($('outnames' + i).length > 0){
								//document.writeln("<div class= outnames"+i.toString()+" ><script type=\"text/javascript\" src="+outnames[i]+"\>\</script\></div>");
							//document.getElementById('container').syle.display = "none";
     					//	document.getElementById('container' + i.toString()).display = '';
							//}
							//$('.outnames' + i.toString()).show();
     						//$('.outnames' + (i-1).toString()).hide();
							//$('<script>').attr('src', outnames[i]).appendTo('head');
							//$('script[src="' + outnames[i-1] + '"]').remove();
							//current = i;
     						$('#container'+(i-1).toString()).hide();
     						$('#container' +(i).toString()).show();
							console.log("moved up"+ i.toString());

						}
					}
					
					
                }, 100);
            });
		
	</script>
</div>
  </body>
</html>